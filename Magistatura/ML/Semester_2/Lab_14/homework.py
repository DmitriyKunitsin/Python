'''
Компьютерная лингвистика и анализ текста: исследование текста на гендерную принадлежность предложений. 
В приложениях: учебный материал с примерами, задание для выполнения.
'''
MALE_WORDS = {
    "мужчина", "парень", "отец", "брат", "сын", "дядя", "дедушка", "муж", 
    "друг", "коллега", "сосед", "герой", "кандидат", "президент", "вождь", 
    "папа", "тренер", "бизнесмен", "инженер", "учёный", "художник", 
    "писатель", "музыкант", "актёр", "волонтёр", "лидер", "менеджер", 
    "спортсмен", "администратор", "аналитик", "дизайнер", "коуч", 
    "ментор", "исследователь", "психолог", "юрист", "экономист", 
    "стратег", "фармацевт", "активист", "куратор", "инструктор", 
    "мужчина-воин", "босс", "шофёр", "футболист", "боксер", 
    "пилот", "механик", "программист", "дизайнер", "архитектор", 
    "журналист", "фотограф", "блогер", "поэт", "писатель-фантаст", 
    "инвестор", "предприниматель", "гид", "консультант", "технолог", 
    "психотерапевт", "студент", "аспирант", "практикант", "педагог", 
    "профессор", "доктор", "медсестра", "фармацевт", "сотрудник", 
    "работник", "помощник", "помощник-менеджера", "дизайнер-график", 
    "инженер-программист", "специалист", "координатор", "планировщик", 
    "аналитик-данных", "менеджер-проектов", "руководитель", "начальник", 
    "партнёр", "друг-соратник", "наставник", "проводник", "техник", 
    "рабочий", "слесарь", "электрик", "столяр", "грузчик", 
    "водитель", "охранник", "сварщик", "моделист", "швея", 
    "пекарь", "повар", "кондитер", "плотник", "стратег", 
    "дизайнер-интерьеров", "инженер-строитель", "врач", "юрист-адвокат", 
    "судья", "прокурор", "психолог-консультант", "мужчина-актер", 
    "мужчина-музыкант", "мужчина-артист", "мужчина-дизайнер", 
    "мужчина-фотограф", "мужчина-журналист", "мужчина-учитель", 
    "мужчина-исследователь", "мужчина-аналитик", "мужчина-менеджер", 
    "мужчина-коуч", "мужчина-ментор", "мужчина-эксперт", 
    "мужчина-активист", "мужчина-волонтёр", "мужчина-организатор", 
    "мужчина-учёный", "мужчина-стратег", "мужчина-менеджер", 
    "мужчина-администратор", "мужчина-инструктор", "мужчина-куратор", 
    "мужчина-специалист", "мужчина-предприниматель", "мужчина-изобретатель",
    "мужчина-дизайнер", "мужчина-архитектор", "мужчина-эксперт", 
    "мужчина-аналитик", "мужчина-менеджер", "мужчина-координатор", 
    "мужчина-программист", "мужчина-работник", "мужчина-студент", 
    "мужчина-аспирант", "мужчина-стажёр", "мужчина-работник", 
    "мужчина-учёный", "муж"
}
FEMALE_WORDS = {
    "женщина", "девушка", "мать", "сестра", "дочь", "тётя", "бабушка", "жена", 
    "подруга", "коллега", "соседка", "героиня", "кандидатка", "президентша", 
    "вождь", "мама", "тренерка", "бизнесвумен", "инженерка", "учёная", 
    "художница", "писательница", "музыкантка", "актриса", "волонтёрка", 
    "лидерша", "менеджерка", "спортсменка", "администраторка", "аналитик", 
    "дизайнерка", "коуч", "менторка", "исследовательница", "психологиня", 
    "юристка", "экономистка", "стратегиня", "фармацевтка", "активистка", 
    "кураторка", "инструкторка", "женщина-воин", "босс", "водительница", 
    "футболистка", "боксерка", "пилотесса", "механичка", "программистка", 
    "архитекторка", "журналистка", "фотографиня", "блогерша", "поэтесса", 
    "инвесторка", "предпринимательница", "гид", "консультантка", "психотерапевтка", 
    "студентка", "аспирантка", "педагогиня", "профессорка", "докторша", 
    "медсестра", "сотрудница", "работница", "помощница", "дизайнерка-график", 
    "инженерка-строитель", "врач", "юристка-адвокат", "судья", 
    "прокурорка", "психологиня-консультантка", "женщина-актер", 
    "женщина-музыкант", "женщина-артист", "женщина-дизайнер", 
    "женщина-фотограф", "женщина-журналист", "женщина-учитель", 
    "женщина-исследователь", "женщина-аналитик", "женщина-менеджер", 
    "женщина-коуч", "женщина-ментор", "женщина-эксперт", 
    "женщина-активист", "женщина-волонтёр", "женщина-организатор", 
    "женщина-предприниматель", "женщина-изобретатель", "женщина-стратег", 
    "женщина-куратор", "женщина-специалист", "женщина-работник", 
    "женщина-стажёр", "женщина-менеджер", "женщина-аналитик", 
    "женщина-координатор", "женщина-программист", "женщина-студент", 
    "женщина-аспирантка", "женщина-учёная", "женщина-логист", 
    "женщина-маркетолог", "женщина-менеджер", "женщина-советник", 
    "женщина-модератор", "женщина-эксперт", "женщина-аналитик", 
    "женщина-руководитель", "женщина-организатор", "женщина-директор", 
    "женщина-куратор", "женщина-представитель", "женщина-агент", 
    "женщина-координатор", "женщина-дизайнер", "женщина-ведущая", 
    "женщина-администратор", "женщина-руководитель", "женщина-оператор", 
    "женщина-менеджер", "женщина-аналитик", "женщина-стратег", 
    "женщина-эксперт", "женщина-учёная", "женщина-исследователь", 
    "женщина-координатор", "женщина-менеджер", "женщина-директор", 
    "женщина-специалист", "женщина-работник", "женщина-стажёр"
}

''' 
2. Создайте функцию genderize, которая подсчитывает количество слов в
предложении, попадающих в списки MALE_WORDS и FEMALE_WORDS. Если
предложение содержит только слова из MALE_WORDS, оно классифицируется как
мужское. Предложение, содержащее только слова из FEMALE_WORDS,
классифицируется как женское. Если предложение содержит мужские и женские
слова, отнесите его к категории двуполых; а если в нем нет ни мужских, ни женских
слов, определите его как имеющее неизвестный род. Функция возвращает
русские наименования категорий!
'''
def genderize(words):
    mwlen = len(MALE_WORDS.intersection(words))
    fwlen = len(FEMALE_WORDS.intersection(words))
    
    if mwlen > 0 and fwlen == 0:
        return "мужское"
    elif mwlen == 0 and fwlen > 0:
        return "женское"
    elif mwlen > 0 and fwlen > 0:
        return "двуполый"
    else:
        return "неизвестный род"


'''
3. Напишите функцию, которая будет подсчитывать частоту слов, признаков
рода и предложений во всем тексте статьи.
'''
def cnt_sets_features(sentences):
    from collections import Counter 
    sents = Counter()
    words = Counter() 
    for sentence in sentences:
        gender = genderize(set(sentence)) 
        sents[gender] += 1 
        words[gender] += len(set(sentence))
    return sents, words

'''
4. Используя библиотеку NLTK, разбейте абзацы на предложения. Выделив
отдельные предложения, разбейте их на лексемы, чтобы выявить отдельные слова
и знаки пунктуации, и передайте размеченный текст функциям классификации для
вывода процентов предложений и слов, относящихся к категории мужских,
женских, двуполых и неизвестной принадлежности. 
'''
def analyze_text(text):
    import nltk
    nltk.download('punkt_tab') 

    sentences = nltk.sent_tokenize(text, language='russian')
    
    tokenized_sentences = [nltk.word_tokenize(sentence, language='russian') for sentence in sentences]

    sents, words = cnt_sets_features(tokenized_sentences)
    
    total = sum(words.values())
    
    for gender, count in words.items():
        pcent = (count / total) * 100
        nsents = sents[gender]
        print("{:.3f}% {} ({} sentences)".format(pcent, gender, nsents))
    


test_text = [
    "мужчина", "парень", "отец", 
    "брат", "сын", "дядя", "дедушка", "муж",
    "Мужчина и женщина идут по улице.",
    "Она - успешная бизнесвумен и мать двоих детей.",
    "Он - инженер и отличный отец.",
    "Девушка и парень обсуждают свои планы на будущее.",
    "Группа студентов готовится к экзаменам.",
    "В этом проекте участвуют как мужчины, так и женщины.",
    "Неизвестный человек наблюдает за ними.",
    "Соседка часто помогает мне с домашними делами.",
    "Психолог работает с клиентами обоих полов.",
    "На конференции выступают известные ученые и исследователи."
]

text = "\Мистер и миссис Дурсль проживали в доме номер четыре по Тисовой улице и всегда с гордостью заявляли, что они, слава богу, абсолютно нормальные люди. Уж от кого-кого, а от них никак нельзя было ожидать, чтобы они попали в какую-нибудь странную или загадочную ситуацию. Мистер и миссис Дурсль весьма неодобрительно относились к любым странностям, загадкам и прочей ерунде."\
"Мистер Дурсль возглавлял фирму под названием «Граннингс», которая специализировалась на производстве дрелей. Это был полный мужчина с очень пышными усами и очень короткой шеей. Что же касается миссис Дурсль, она была тощей блондинкой с шеей почти вдвое длиннее, чем положено при ее росте. Однако этот недостаток пришелся ей весьма кстати, поскольку большую часть времени миссис Дурсль следила за соседями и подслушивала их разговоры. А с такой шеей, как у нее, было очень удобно заглядывать за чужие заборы. У мистера и миссис Дурсль был маленький сын по имени Дадли, и, по их мнению, он был самым чудесным ребенком на свете."\
"Семья Дурслей имела все, чего только можно пожелать. Но был у них и один секрет. Причем больше всего на свете они боялись, что кто-нибудь о нем узнает. Дурсли даже представить себе не могли, что с ними будет, если выплывет правда о Поттерах. Миссис Поттер приходилась миссис Дурсль родной сестрой, но они не виделись вот уже несколько лет. Миссис Дурсль даже делала вид, что у нее вовсе нет никакой сестры, потому что сестра и ее никчемный муж были полной противоположностью Дурслям."\
"Дурсли содрогались при одной мысли о том, что скажут соседи, если на Тисовую улицу пожалуют Поттеры. Дурсли знали, что у Поттеров тоже есть маленький сын, но они никогда его не видели. И они категорически не хотели, чтобы их Дадли общался с ребенком таких родителей."\
"Когда во вторник мистер и миссис Дурсль проснулись скучным и серым утром — а именно с этого утра начинается наша история, — ничто, включая покрытое тучами небо, не предвещало, что вскоре по всей стране начнут происходить странные и загадочные вещи. Мистер Дурсль что-то напевал себе под нос, завязывая самый отвратительный из своих галстуков. А миссис Дурсль, с трудом усадив сопротивляющегося и орущего Дадли на высокий детский стульчик, со счастливой улыбкой пересказывала мужу последние сплетни."\
"Никто из них не заметил, как за окном пролетела большая сова-неясыть."\
"В половине девятого мистер Дурсль взял свой портфель, клюнул миссис Дурсль в щеку и попытался на прощанье поцеловать Дадли, но промахнулся, потому что Дадли впал в ярость, что с ним происходило довольно часто. Он раскачивался взад-вперед на стульчике, ловко выуживал из тарелки кашу и заляпывал ею стены."\
"— Ух, ты моя крошка, — со смехом выдавил из себя мистер Дурсль, выходя из дома."\
"Он сел в машину и выехал со двора."\
"На углу улицы мистер Дурсль заметил, что происходит что-то странное, — на тротуаре стояла кошка и внимательно изучала лежащую перед ней карту. В первую секунду мистер Дурсль даже не понял, что именно он увидел, но затем, уже миновав кошку, затормозил и резко оглянулся. На углу Тисовой улицы действительно стояла полосатая кошка, но никакой карты видно не было."\
"— И привидится же такое! — буркнул мистер Дурсль."\
"Наверное, во всем были виноваты мрачное утро и тусклый свет фонаря. На всякий случай мистер Дурсль закрыл глаза, потом открыл их и уставился на кошку. А кошка уставилась на него."\
"Мистер Дурсль отвернулся и поехал дальше, продолжая следить за кошкой в зеркало заднего вида. Он заметил, что кошка читает табличку, на которой написано «Тисовая улица». Нет, конечно же не читает, поспешно поправил он самого себя, а просто смотрит на табличку. Ведь кошки не умеют читать — равно как и изучать карты."\
"Мистер Дурсль потряс головой и попытался выбросить из нее кошку. И пока его автомобиль ехал к Лондону из пригорода, мистер Дурсль думал о крупном заказе на дрели, который рассчитывал сегодня получить."\
"Но когда он подъехал к Лондону, заполнившие его голову дрели вылетели оттуда в мгновение ока, потому что, попав в обычную утреннюю автомобильную пробку и от нечего делать глядя по сторонам, мистер Дурсль заметил, что на улицах появилось множество очень странно одетых людей. Людей в мантиях. Мистер Дурсль не переносил людей в нелепой одежде, да взять хотя бы нынешнюю молодежь, которая расхаживает черт знает в чем! И вот теперь эти, нарядившиеся по какой-то дурацкой моде."\
"Мистер Дурсль забарабанил пальцами по рулю. Его взгляд упал на сгрудившихся неподалеку странных типов, оживленно шептавшихся друг с другом. Мистер Дурсль пришел в ярость, увидев, что некоторые из них совсем не молоды, — подумать только, один из мужчин выглядел даже старше него, а позволил себе облачиться в изумрудно-зеленую мантию! Ну и тип! Но тут мистера Дурсля осенила мысль, что эти непонятные личности наверняка всего лишь собирают пожертвования или что-нибудь в этом роде… Так оно и есть! Стоявшие в пробке машины наконец тронулись с места, и несколько минут спустя мистер Дурсль въехал на парковку фирмы «Граннингс». Его голова снова была забита дрелями."\
"Кабинет мистера Дурсля находился на девятом этаже, где он всегда сидел спиной к окну. Предпочитай он сидеть лицом к окну, ему, скорее всего, трудно было бы этим утром сосредоточиться на дрелях. Но он сидел к окну спиной и не видел пролетающих сов — подумать только, сов, летающих не ночью, когда им и положено, а средь бела дня! И это уже не говоря о том, что совы — лесные птицы, и в городах, тем более таких больших, как Лондон, не живут."\
"В отличие от мистера Дурсля, находившиеся на улице люди отлично видели этих сов, стремительно пролетающих мимо них одна за другой, и широко раскрывали рты от удивления и показывали на них пальцами. Большинство этих людей в жизни своей не видели ни единой совы, даже в ночное время."\
"В общем, у мистера Дурсля было вполне нормальное, лишенное сов утро. Он накричал на пятерых подчиненных, сделал несколько важных звонков и несколько раз повысил голос на своих телефонных собеседников. Так что настроение у него было просто отличное — до тех пор, пока он не решил немного размять ноги и купить себе булочку в булочной напротив."\
"Мистер Дурсль уже забыл о людях в мантиях и не вспоминал о них, пока не столкнулся с группкой странных типов неподалеку от булочной. Он не мог понять, почему при одном только взгляде на них ему становилось не по себе."\
"Эти типы тоже оживленно перешептывались, и он не заметил у них в руках ни одной кружки для сбора пожертвований. Выйдя из булочной с пакетом, в котором лежал большой пончик, мистер Дурсль вновь вынужден был пройти мимо этих странных личностей, и в этот момент он абсолютно случайно услышал"
def main():
    analyze_text(text)

if __name__ == '__main__':
    main()

